// Menu Wiz - Wilson Young (yyfearth@gmail.com) - Dynamic6 @ sjsu.yyfearth.com (w/ Zepto & Modernizr 2.0.6)
var Zepto=function(){function O(e){return e==null?String(e):T[N.call(e)]||"object"}function M(e){return O(e)=="function"}function _(e){return e!=null&&e==e.window}function D(e){return e!=null&&e.nodeType==e.DOCUMENT_NODE}function P(e){return O(e)=="object"}function H(e){return P(e)&&!_(e)&&e.__proto__==Object.prototype}function B(e){return e instanceof Array}function j(e){return typeof e.length=="number"}function F(e){return o.call(e,function(e){return e!=null})}function I(e){return e.length>0?n.fn.concat.apply([],e):e}function q(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function R(e){return e in f?f[e]:f[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function U(e,t){return typeof t=="number"&&!c[q(e)]?t+"px":t}function z(e){var t,n;return a[e]||(t=u.createElement(e),u.body.appendChild(t),n=l(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),n=="none"&&(n="block"),a[e]=n),a[e]}function W(e){return"children"in e?s.call(e.children):n.map(e.childNodes,function(e){if(e.nodeType==1)return e})}function X(n,r,i){for(t in r)i&&H(r[t])?(H(n[t])||(n[t]={}),X(n[t],r[t],i)):r[t]!==e&&(n[t]=r[t])}function V(t,r){return r===e?n(t):n(t).filter(r)}function $(e,t,n,r){return M(t)?t.call(e,n,r):t}function J(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function K(t,n){var r=t.className,i=r&&r.baseVal!==e;if(n===e)return i?r.baseVal:r;i?r.baseVal=n:t.className=n}function Q(e){var t;try{return e?e=="true"||(e=="false"?!1:e=="null"?null:isNaN(t=Number(e))?/^[\[\{]/.test(e)?n.parseJSON(e):e:t):e}catch(r){return e}}function G(e,t){t(e);for(var n in e.childNodes)G(e.childNodes[n],t)}var e,t,n,r,i=[],s=i.slice,o=i.filter,u=window.document,a={},f={},l=u.defaultView.getComputedStyle,c={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},h=/^\s*<(\w+|!)[^>]*>/,p=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,d=/^(?:body|html)$/i,v=["val","css","html","text","data","width","height","offset"],m=["after","prepend","before","append"],g=u.createElement("table"),y=u.createElement("tr"),b={tr:u.createElement("tbody"),tbody:g,thead:g,tfoot:g,td:y,th:y,"*":u.createElement("div")},w=/complete|loaded|interactive/,E=/^\.([\w-]+)$/,S=/^#([\w-]*)$/,x=/^[\w-]+$/,T={},N=T.toString,C={},k,L,A=u.createElement("div");return C.matches=function(e,t){if(!e||e.nodeType!==1)return!1;var n=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(n)return n.call(e,t);var r,i=e.parentNode,s=!i;return s&&(i=A).appendChild(e),r=~C.qsa(i,t).indexOf(e),s&&A.removeChild(e),r},k=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},L=function(e){return o.call(e,function(t,n){return e.indexOf(t)==n})},C.fragment=function(t,r,i){t.replace&&(t=t.replace(p,"<$1></$2>")),r===e&&(r=h.test(t)&&RegExp.$1),r in b||(r="*");var o,u,a=b[r];return a.innerHTML=""+t,u=n.each(s.call(a.childNodes),function(){a.removeChild(this)}),H(i)&&(o=n(u),n.each(i,function(e,t){v.indexOf(e)>-1?o[e](t):o.attr(e,t)})),u},C.Z=function(e,t){return e=e||[],e.__proto__=n.fn,e.selector=t||"",e},C.isZ=function(e){return e instanceof C.Z},C.init=function(t,r){if(!t)return C.Z();if(M(t))return n(u).ready(t);if(C.isZ(t))return t;var i;if(B(t))i=F(t);else if(P(t))i=[H(t)?n.extend({},t):t],t=null;else if(h.test(t))i=C.fragment(t.trim(),RegExp.$1,r),t=null;else{if(r!==e)return n(r).find(t);i=C.qsa(u,t)}return C.Z(i,t)},n=function(e,t){return C.init(e,t)},n.extend=function(e){var t,n=s.call(arguments,1);return typeof e=="boolean"&&(t=e,e=n.shift()),n.forEach(function(n){X(e,n,t)}),e},C.qsa=function(e,t){var n;return D(e)&&S.test(t)?(n=e.getElementById(RegExp.$1))?[n]:[]:e.nodeType!==1&&e.nodeType!==9?[]:s.call(E.test(t)?e.getElementsByClassName(RegExp.$1):x.test(t)?e.getElementsByTagName(t):e.querySelectorAll(t))},n.contains=function(e,t){return e!==t&&e.contains(t)},n.type=O,n.isFunction=M,n.isWindow=_,n.isArray=B,n.isPlainObject=H,n.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},n.inArray=function(e,t,n){return i.indexOf.call(t,e,n)},n.camelCase=k,n.trim=function(e){return e.trim()},n.uuid=0,n.support={},n.expr={},n.map=function(e,t){var n,r=[],i,s;if(j(e))for(i=0;i<e.length;i++)n=t(e[i],i),n!=null&&r.push(n);else for(s in e)n=t(e[s],s),n!=null&&r.push(n);return I(r)},n.each=function(e,t){var n,r;if(j(e)){for(n=0;n<e.length;n++)if(t.call(e[n],n,e[n])===!1)return e}else for(r in e)if(t.call(e[r],r,e[r])===!1)return e;return e},n.grep=function(e,t){return o.call(e,t)},window.JSON&&(n.parseJSON=JSON.parse),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){T["[object "+t+"]"]=t.toLowerCase()}),n.fn={forEach:i.forEach,reduce:i.reduce,push:i.push,sort:i.sort,indexOf:i.indexOf,concat:i.concat,map:function(e){return n(n.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return n(s.apply(this,arguments))},ready:function(e){return w.test(u.readyState)?e(n):u.addEventListener("DOMContentLoaded",function(){e(n)},!1),this},get:function(t){return t===e?s.call(this):this[t>=0?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){this.parentNode!=null&&this.parentNode.removeChild(this)})},each:function(e){return i.every.call(this,function(t,n){return e.call(t,n,t)!==!1}),this},filter:function(e){return M(e)?this.not(this.not(e)):n(o.call(this,function(t){return C.matches(t,e)}))},add:function(e,t){return n(L(this.concat(n(e,t))))},is:function(e){return this.length>0&&C.matches(this[0],e)},not:function(t){var r=[];if(M(t)&&t.call!==e)this.each(function(e){t.call(this,e)||r.push(this)});else{var i=typeof t=="string"?this.filter(t):j(t)&&M(t.item)?s.call(t):n(t);this.forEach(function(e){i.indexOf(e)<0&&r.push(e)})}return n(r)},has:function(e){return this.filter(function(){return P(e)?n.contains(this,e):n(this).find(e).size()})},eq:function(e){return e===-1?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!P(e)?e:n(e)},last:function(){var e=this[this.length-1];return e&&!P(e)?e:n(e)},find:function(e){var t;return this.length==1?t=n(C.qsa(this[0],e)):t=this.map(function(){return C.qsa(this,e)}),t},closest:function(e,t){var r=this[0];while(r&&!C.matches(r,e))r=r!==t&&!D(r)&&r.parentNode;return n(r)},parents:function(e){var t=[],r=this;while(r.length>0)r=n.map(r,function(e){if((e=e.parentNode)&&!D(e)&&t.indexOf(e)<0)return t.push(e),e});return V(t,e)},parent:function(e){return V(L(this.pluck("parentNode")),e)},children:function(e){return V(this.map(function(){return W(this)}),e)},contents:function(){return this.map(function(){return s.call(this.childNodes)})},siblings:function(e){return V(this.map(function(e,t){return o.call(W(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return n.map(this,function(t){return t[e]})},show:function(){return this.each(function(){this.style.display=="none"&&(this.style.display=null),l(this,"").getPropertyValue("display")=="none"&&(this.style.display=z(this.nodeName))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){var t=M(e);if(this[0]&&!t)var r=n(e).get(0),i=r.parentNode||this.length>1;return this.each(function(s){n(this).wrapAll(t?e.call(this,s):i?r.cloneNode(!0):r)})},wrapAll:function(e){if(this[0]){n(this[0]).before(e=n(e));var t;while((t=e.children()).length)e=t.first();n(e).append(this)}return this},wrapInner:function(e){var t=M(e);return this.each(function(r){var i=n(this),s=i.contents(),o=t?e.call(this,r):e;s.length?s.wrapAll(o):i.append(o)})},unwrap:function(){return this.parent().each(function(){n(this).replaceWith(n(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var r=n(this);(t===e?r.css("display")=="none":t)?r.show():r.hide()})},prev:function(e){return n(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return n(this.pluck("nextElementSibling")).filter(e||"*")},html:function(t){return t===e?this.length>0?this[0].innerHTML:null:this.each(function(e){var r=this.innerHTML;n(this).empty().append($(this,t,e,r))})},text:function(t){return t===e?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=t})},attr:function(n,r){var i;return typeof n=="string"&&r===e?this.length==0||this[0].nodeType!==1?e:n=="value"&&this[0].nodeName=="INPUT"?this.val():!(i=this[0].getAttribute(n))&&n in this[0]?this[0][n]:i:this.each(function(e){if(this.nodeType!==1)return;if(P(n))for(t in n)J(this,t,n[t]);else J(this,n,$(this,r,e,this.getAttribute(n)))})},removeAttr:function(e){return this.each(function(){this.nodeType===1&&J(this,e)})},prop:function(t,n){return n===e?this[0]&&this[0][t]:this.each(function(e){this[t]=$(this,n,e,this[t])})},data:function(t,n){var r=this.attr("data-"+q(t),n);return r!==null?Q(r):e},val:function(t){return t===e?this[0]&&(this[0].multiple?n(this[0]).find("option").filter(function(e){return this.selected}).pluck("value"):this[0].value):this.each(function(e){this.value=$(this,t,e,this.value)})},offset:function(e){if(e)return this.each(function(t){var r=n(this),i=$(this,e,t,r.offset()),s=r.offsetParent().offset(),o={top:i.top-s.top,left:i.left-s.left};r.css("position")=="static"&&(o.position="relative"),r.css(o)});if(this.length==0)return null;var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:t.width,height:t.height}},css:function(e,n){if(arguments.length<2&&typeof e=="string")return this[0]&&(this[0].style[k(e)]||l(this[0],"").getPropertyValue(e));var r="";for(t in e)!e[t]&&e[t]!==0?this.each(function(){this.style.removeProperty(q(t))}):r+=q(t)+":"+U(t,e[t])+";";return typeof e=="string"&&(!n&&n!==0?this.each(function(){this.style.removeProperty(q(e))}):r=q(e)+":"+U(e,n)),this.each(function(){this.style.cssText+=";"+r})},index:function(e){return e?this.indexOf(n(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return i.some.call(this,function(e){return this.test(K(e))},R(e))},addClass:function(e){return this.each(function(t){r=[];var i=K(this),s=$(this,e,t,i);s.split(/\s+/g).forEach(function(e){n(this).hasClass(e)||r.push(e)},this),r.length&&K(this,i+(i?" ":"")+r.join(" "))})},removeClass:function(t){return this.each(function(n){if(t===e)return K(this,"");r=K(this),$(this,t,n,r).split(/\s+/g).forEach(function(e){r=r.replace(R(e)," ")}),K(this,r.trim())})},toggleClass:function(t,r){return this.each(function(i){var s=n(this),o=$(this,t,i,K(this));o.split(/\s+/g).forEach(function(t){(r===e?!s.hasClass(t):r)?s.addClass(t):s.removeClass(t)})})},scrollTop:function(){if(!this.length)return;return"scrollTop"in this[0]?this[0].scrollTop:this[0].scrollY},position:function(){if(!this.length)return;var e=this[0],t=this.offsetParent(),r=this.offset(),i=d.test(t[0].nodeName)?{top:0,left:0}:t.offset();return r.top-=parseFloat(n(e).css("margin-top"))||0,r.left-=parseFloat(n(e).css("margin-left"))||0,i.top+=parseFloat(n(t[0]).css("border-top-width"))||0,i.left+=parseFloat(n(t[0]).css("border-left-width"))||0,{top:r.top-i.top,left:r.left-i.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||u.body;while(e&&!d.test(e.nodeName)&&n(e).css("position")=="static")e=e.offsetParent;return e})}},n.fn.detach=n.fn.remove,["width","height"].forEach(function(t){n.fn[t]=function(r){var i,s=this[0],o=t.replace(/./,function(e){return e[0].toUpperCase()});return r===e?_(s)?s["inner"+o]:D(s)?s.documentElement["offset"+o]:(i=this.offset())&&i[t]:this.each(function(e){s=n(this),s.css(t,$(this,r,e,s[t]()))})}}),m.forEach(function(e,t){var r=t%2;n.fn[e]=function(){var e,i=n.map(arguments,function(t){return e=O(t),e=="object"||e=="array"||t==null?t:C.fragment(t)}),s,o=this.length>1;return i.length<1?this:this.each(function(e,u){s=r?u:u.parentNode,u=t==0?u.nextSibling:t==1?u.firstChild:t==2?u:null,i.forEach(function(e){if(o)e=e.cloneNode(!0);else if(!s)return n(e).remove();G(s.insertBefore(e,u),function(e){e.nodeName!=null&&e.nodeName.toUpperCase()==="SCRIPT"&&(!e.type||e.type==="text/javascript")&&!e.src&&window.eval.call(window,e.innerHTML)})})})},n.fn[r?e+"To":"insert"+(t?"Before":"After")]=function(t){return n(t)[e](this),this}}),C.Z.prototype=n.fn,C.uniq=L,C.deserializeValue=Q,n.zepto=C,n}();window.Zepto=Zepto,"$"in window||(window.$=Zepto),function(e){function o(e){return e._zid||(e._zid=r++)}function u(e,t,r,i){t=a(t);if(t.ns)var s=f(t.ns);return(n[o(e)]||[]).filter(function(e){return e&&(!t.e||e.e==t.e)&&(!t.ns||s.test(e.ns))&&(!r||o(e.fn)===o(r))&&(!i||e.sel==i)})}function a(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function f(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}function l(t,n,r){e.type(t)!="string"?e.each(t,r):t.split(/\s/).forEach(function(e){r(e,n)})}function c(e,t){return e.del&&(e.e=="focus"||e.e=="blur")||!!t}function h(e){return s[e]||e}function p(t,r,i,u,f,p){var d=o(t),v=n[d]||(n[d]=[]);l(r,i,function(n,r){var i=a(n);i.fn=r,i.sel=u,i.e in s&&(r=function(t){var n=t.relatedTarget;if(!n||n!==this&&!e.contains(this,n))return i.fn.apply(this,arguments)}),i.del=f&&f(r,n);var o=i.del||r;i.proxy=function(e){var n=o.apply(t,[e].concat(e.data));return n===!1&&(e.preventDefault(),e.stopPropagation()),n},i.i=v.length,v.push(i),t.addEventListener(h(i.e),i.proxy,c(i,p))})}function d(e,t,r,i,s){var a=o(e);l(t||"",r,function(t,r){u(e,t,r,i).forEach(function(t){delete n[a][t.i],e.removeEventListener(h(t.e),t.proxy,c(t,s))})})}function b(t){var n,r={originalEvent:t};for(n in t)!g.test(n)&&t[n]!==undefined&&(r[n]=t[n]);return e.each(y,function(e,n){r[e]=function(){return this[n]=v,t[e].apply(t,arguments)},r[n]=m}),r}function w(e){if(!("defaultPrevented"in e)){e.defaultPrevented=!1;var t=e.preventDefault;e.preventDefault=function(){this.defaultPrevented=!0,t.call(this)}}}var t=e.zepto.qsa,n={},r=1,i={},s={mouseenter:"mouseover",mouseleave:"mouseout"};i.click=i.mousedown=i.mouseup=i.mousemove="MouseEvents",e.event={add:p,remove:d},e.proxy=function(t,n){if(e.isFunction(t)){var r=function(){return t.apply(n,arguments)};return r._zid=o(t),r}if(typeof n=="string")return e.proxy(t[n],t);throw new TypeError("expected function")},e.fn.bind=function(e,t){return this.each(function(){p(this,e,t)})},e.fn.unbind=function(e,t){return this.each(function(){d(this,e,t)})},e.fn.one=function(e,t){return this.each(function(n,r){p(this,e,t,null,function(e,t){return function(){var n=e.apply(r,arguments);return d(r,t,e),n}})})};var v=function(){return!0},m=function(){return!1},g=/^([A-Z]|layer[XY]$)/,y={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};e.fn.delegate=function(t,n,r){return this.each(function(i,s){p(s,n,r,t,function(n){return function(r){var i,o=e(r.target).closest(t,s).get(0);if(o)return i=e.extend(b(r),{currentTarget:o,liveFired:s}),n.apply(o,[i].concat([].slice.call(arguments,1)))}})})},e.fn.undelegate=function(e,t,n){return this.each(function(){d(this,t,n,e)})},e.fn.live=function(t,n){return e(document.body).delegate(this.selector,t,n),this},e.fn.die=function(t,n){return e(document.body).undelegate(this.selector,t,n),this},e.fn.on=function(t,n,r){return!n||e.isFunction(n)?this.bind(t,n||r):this.delegate(n,t,r)},e.fn.off=function(t,n,r){return!n||e.isFunction(n)?this.unbind(t,n||r):this.undelegate(n,t,r)},e.fn.trigger=function(t,n){if(typeof t=="string"||e.isPlainObject(t))t=e.Event(t);return w(t),t.data=n,this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(t)})},e.fn.triggerHandler=function(t,n){var r,i;return this.each(function(s,o){r=b(typeof t=="string"?e.Event(t):t),r.data=n,r.target=o,e.each(u(o,t.type||t),function(e,t){i=t.proxy(r);if(r.isImmediatePropagationStopped())return!1})}),i},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(t){e.fn[t]=function(e){return e?this.bind(t,e):this.trigger(t)}}),["focus","blur"].forEach(function(t){e.fn[t]=function(e){return e?this.bind(t,e):this.each(function(){try{this[t]()}catch(e){}}),this}}),e.Event=function(e,t){typeof e!="string"&&(t=e,e=t.type);var n=document.createEvent(i[e]||"Events"),r=!0;if(t)for(var s in t)s=="bubbles"?r=!!t[s]:n[s]=t[s];return n.initEvent(e,r,!0,null,null,null,null,null,null,null,null,null,null,null,null),n.isDefaultPrevented=function(){return this.defaultPrevented},n}}(Zepto),function(e){function t(e){var t=this.os={},n=this.browser={},r=e.match(/WebKit\/([\d.]+)/),i=e.match(/(Android)\s+([\d.]+)/),s=e.match(/(iPad).*OS\s([\d_]+)/),o=!s&&e.match(/(iPhone\sOS)\s([\d_]+)/),u=e.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),a=u&&e.match(/TouchPad/),f=e.match(/Kindle\/([\d.]+)/),l=e.match(/Silk\/([\d._]+)/),c=e.match(/(BlackBerry).*Version\/([\d.]+)/),h=e.match(/(BB10).*Version\/([\d.]+)/),p=e.match(/(RIM\sTablet\sOS)\s([\d.]+)/),d=e.match(/PlayBook/),v=e.match(/Chrome\/([\d.]+)/)||e.match(/CriOS\/([\d.]+)/),m=e.match(/Firefox\/([\d.]+)/);if(n.webkit=!!r)n.version=r[1];i&&(t.android=!0,t.version=i[2]),o&&(t.ios=t.iphone=!0,t.version=o[2].replace(/_/g,".")),s&&(t.ios=t.ipad=!0,t.version=s[2].replace(/_/g,".")),u&&(t.webos=!0,t.version=u[2]),a&&(t.touchpad=!0),c&&(t.blackberry=!0,t.version=c[2]),h&&(t.bb10=!0,t.version=h[2]),p&&(t.rimtabletos=!0,t.version=p[2]),d&&(n.playbook=!0),f&&(t.kindle=!0,t.version=f[1]),l&&(n.silk=!0,n.version=l[1]),!l&&t.android&&e.match(/Kindle Fire/)&&(n.silk=!0),v&&(n.chrome=!0,n.version=v[1]),m&&(n.firefox=!0,n.version=m[1]),t.tablet=!!(s||d||i&&!e.match(/Mobile/)||m&&e.match(/Tablet/)),t.phone=!t.tablet&&!!(i||o||u||c||h||v||m)}t.call(e,navigator.userAgent),e.__detect=t}(Zepto),function(e,t){function y(e){return b(e.replace(/([a-z])([A-Z])/,"$1-$2"))}function b(e){return e.toLowerCase()}function w(e){return r?r+e:b(e)}var n="",r,i,s,o={Webkit:"webkit",Moz:"",O:"o",ms:"MS"},u=window.document,a=u.createElement("div"),f=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,l,c,h,p,d,v,m,g={};e.each(o,function(e,i){if(a.style[e+"TransitionProperty"]!==t)return n="-"+b(e)+"-",r=i,!1}),l=n+"transform",g[c=n+"transition-property"]=g[h=n+"transition-duration"]=g[p=n+"transition-timing-function"]=g[d=n+"animation-name"]=g[v=n+"animation-duration"]=g[m=n+"animation-timing-function"]="",e.fx={off:r===t&&a.style.transitionProperty===t,speeds:{_default:400,fast:200,slow:600},cssPrefix:n,transitionEnd:w("TransitionEnd"),animationEnd:w("AnimationEnd")},e.fn.animate=function(t,n,r,i){return e.isPlainObject(n)&&(r=n.easing,i=n.complete,n=n.duration),n&&(n=(typeof n=="number"?n:e.fx.speeds[n]||e.fx.speeds._default)/1e3),this.anim(t,n,r,i)},e.fn.anim=function(n,r,i,s){var o,u={},a,b="",w=this,E,S=e.fx.transitionEnd;r===t&&(r=.4),e.fx.off&&(r=0);if(typeof n=="string")u[d]=n,u[v]=r+"s",u[m]=i||"linear",S=e.fx.animationEnd;else{a=[];for(o in n)f.test(o)?b+=o+"("+n[o]+") ":(u[o]=n[o],a.push(y(o)));b&&(u[l]=b,a.push(l)),r>0&&typeof n=="object"&&(u[c]=a.join(", "),u[h]=r+"s",u[p]=i||"linear")}return E=function(t){if(typeof t!="undefined"){if(t.target!==t.currentTarget)return;e(t.target).unbind(S,E)}e(this).css(g),s&&s.call(this)},r>0&&this.bind(S,E),this.size()&&this.get(0).clientLeft,this.css(u),r<=0&&setTimeout(function(){w.each(function(){E.call(this)})},0),this},a=null}(Zepto),function($){function triggerAndReturn(e,t,n){var r=$.Event(t);return $(e).trigger(r,n),!r.defaultPrevented}function triggerGlobal(e,t,n,r){if(e.global)return triggerAndReturn(t||document,n,r)}function ajaxStart(e){e.global&&$.active++===0&&triggerGlobal(e,null,"ajaxStart")}function ajaxStop(e){e.global&&!--$.active&&triggerGlobal(e,null,"ajaxStop")}function ajaxBeforeSend(e,t){var n=t.context;if(t.beforeSend.call(n,e,t)===!1||triggerGlobal(t,n,"ajaxBeforeSend",[e,t])===!1)return!1;triggerGlobal(t,n,"ajaxSend",[e,t])}function ajaxSuccess(e,t,n){var r=n.context,i="success";n.success.call(r,e,i,t),triggerGlobal(n,r,"ajaxSuccess",[t,n,e]),ajaxComplete(i,t,n)}function ajaxError(e,t,n,r){var i=r.context;r.error.call(i,n,t,e),triggerGlobal(r,i,"ajaxError",[n,r,e]),ajaxComplete(t,n,r)}function ajaxComplete(e,t,n){var r=n.context;n.complete.call(r,t,e),triggerGlobal(n,r,"ajaxComplete",[t,n]),ajaxStop(n)}function empty(){}function mimeToDataType(e){return e&&(e==htmlType?"html":e==jsonType?"json":scriptTypeRE.test(e)?"script":xmlTypeRE.test(e)&&"xml")||"text"}function appendQuery(e,t){return(e+"&"+t).replace(/[&?]{1,2}/,"?")}function serializeData(e){e.processData&&e.data&&$.type(e.data)!="string"&&(e.data=$.param(e.data,e.traditional)),e.data&&(!e.type||e.type.toUpperCase()=="GET")&&(e.url=appendQuery(e.url,e.data))}function parseArguments(e,t,n,r){var i=!$.isFunction(t);return{url:e,data:i?t:undefined,success:i?$.isFunction(n)?n:undefined:t,dataType:i?r||n:n}}function serialize(e,t,n,r){var i,s=$.isArray(t);$.each(t,function(t,o){i=$.type(o),r&&(t=n?r:r+"["+(s?"":t)+"]"),!r&&s?e.add(o.name,o.value):i=="array"||!n&&i=="object"?serialize(e,o,n,t):e.add(t,o)})}var jsonpID=0,document=window.document,key,name,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,scriptTypeRE=/^(?:text|application)\/javascript/i,xmlTypeRE=/^(?:text|application)\/xml/i,jsonType="application/json",htmlType="text/html",blankRE=/^\s*$/;$.active=0,$.ajaxJSONP=function(e){if("type"in e){var t="jsonp"+ ++jsonpID,n=document.createElement("script"),r=function(){clearTimeout(o),$(n).remove(),delete window[t]},i=function(n){r();if(!n||n=="timeout")window[t]=empty;ajaxError(null,n||"abort",s,e)},s={abort:i},o;return serializeData(e),ajaxBeforeSend(s,e)===!1?(i("abort"),!1):(window[t]=function(t){r(),ajaxSuccess(t,s,e)},n.onerror=function(){i("error")},n.src=e.url.replace(/=\?/,"="+t),$("head").append(n),e.timeout>0&&(o=setTimeout(function(){i("timeout")},e.timeout)),s)}return $.ajax(e)},$.ajaxSettings={type:"GET",beforeSend:empty,success:empty,error:empty,complete:empty,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:jsonType,xml:"application/xml, text/xml",html:htmlType,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0},$.ajax=function(options){var settings=$.extend({},options||{});for(key in $.ajaxSettings)settings[key]===undefined&&(settings[key]=$.ajaxSettings[key]);ajaxStart(settings),settings.crossDomain||(settings.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(settings.url)&&RegExp.$2!=window.location.host);var dataType=settings.dataType,hasPlaceholder=/=\?/.test(settings.url);if(dataType=="jsonp"||hasPlaceholder)return hasPlaceholder||(settings.url=appendQuery(settings.url,"callback=?")),$.ajaxJSONP(settings);settings.url||(settings.url=window.location.toString()),serializeData(settings);var mime=settings.accepts[dataType],baseHeaders={},protocol=/^([\w-]+:)\/\//.test(settings.url)?RegExp.$1:window.location.protocol,xhr=settings.xhr(),abortTimeout;settings.crossDomain||(baseHeaders["X-Requested-With"]="XMLHttpRequest"),mime&&(baseHeaders.Accept=mime,mime.indexOf(",")>-1&&(mime=mime.split(",",2)[0]),xhr.overrideMimeType&&xhr.overrideMimeType(mime));if(settings.contentType||settings.contentType!==!1&&settings.data&&settings.type.toUpperCase()!="GET")baseHeaders["Content-Type"]=settings.contentType||"application/x-www-form-urlencoded";settings.headers=$.extend(baseHeaders,settings.headers||{}),xhr.onreadystatechange=function(){if(xhr.readyState==4){xhr.onreadystatechange=empty,clearTimeout(abortTimeout);var result,error=!1;if(xhr.status>=200&&xhr.status<300||xhr.status==304||xhr.status==0&&protocol=="file:"){dataType=dataType||mimeToDataType(xhr.getResponseHeader("content-type")),result=xhr.responseText;try{dataType=="script"?(1,eval)(result):dataType=="xml"?result=xhr.responseXML:dataType=="json"&&(result=blankRE.test(result)?null:$.parseJSON(result))}catch(e){error=e}error?ajaxError(error,"parsererror",xhr,settings):ajaxSuccess(result,xhr,settings)}else ajaxError(null,xhr.status?"error":"abort",xhr,settings)}};var async="async"in settings?settings.async:!0;xhr.open(settings.type,settings.url,async);for(name in settings.headers)xhr.setRequestHeader(name,settings.headers[name]);return ajaxBeforeSend(xhr,settings)===!1?(xhr.abort(),!1):(settings.timeout>0&&(abortTimeout=setTimeout(function(){xhr.onreadystatechange=empty,xhr.abort(),ajaxError(null,"timeout",xhr,settings)},settings.timeout)),xhr.send(settings.data?settings.data:null),xhr)},$.get=function(e,t,n,r){return $.ajax(parseArguments.apply(null,arguments))},$.post=function(e,t,n,r){var i=parseArguments.apply(null,arguments);return i.type="POST",$.ajax(i)},$.getJSON=function(e,t,n){var r=parseArguments.apply(null,arguments);return r.dataType="json",$.ajax(r)},$.fn.load=function(e,t,n){if(!this.length)return this;var r=this,i=e.split(/\s/),s,o=parseArguments(e,t,n),u=o.success;return i.length>1&&(o.url=i[0],s=i[1]),o.success=function(e){r.html(s?$("<div>").html(e.replace(rscript,"")).find(s):e),u&&u.apply(r,arguments)},$.ajax(o),this};var escape=encodeURIComponent;$.param=function(e,t){var n=[];return n.add=function(e,t){this.push(escape(e)+"="+escape(t))},serialize(n,e,t),n.join("&").replace(/%20/g,"+")}}(Zepto),function(e){e.fn.serializeArray=function(){var t=[],n;return e(Array.prototype.slice.call(this.get(0).elements)).each(function(){n=e(this);var r=n.attr("type");this.nodeName.toLowerCase()!="fieldset"&&!this.disabled&&r!="submit"&&r!="reset"&&r!="button"&&(r!="radio"&&r!="checkbox"||this.checked)&&t.push({name:n.attr("name"),value:n.val()})}),t},e.fn.serialize=function(){var e=[];return this.serializeArray().forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}),e.join("&")},e.fn.submit=function(t){if(t)this.bind("submit",t);else if(this.length){var n=e.Event("submit");this.eq(0).trigger(n),n.defaultPrevented||this.get(0).submit()}return this}}(Zepto),function(e){function i(t){return t=e(t),(!!t.width()||!!t.height())&&t.css("display")!=="none"}function f(e,t){e=e.replace(/=#\]/g,'="#"]');var n,r,i=o.exec(e);if(i&&i[2]in s){n=s[i[2]],r=i[3],e=i[1];if(r){var u=Number(r);isNaN(u)?r=r.replace(/^["']|["']$/g,""):r=u}}return t(e,n,r)}var t=e.zepto,n=t.qsa,r=t.matches,s=e.expr[":"]={visible:function(){if(i(this))return this},hidden:function(){if(!i(this))return this},selected:function(){if(this.selected)return this},checked:function(){if(this.checked)return this},parent:function(){return this.parentNode},first:function(e){if(e===0)return this},last:function(e,t){if(e===t.length-1)return this},eq:function(e,t,n){if(e===n)return this},contains:function(t,n,r){if(e(this).text().indexOf(r)>-1)return this},has:function(e,n,r){if(t.qsa(this,r).length)return this}},o=new RegExp("(.*):(\\w+)(?:\\(([^)]+)\\))?$\\s*"),u=/^\s*>/,a="Zepto"+ +(new Date);t.qsa=function(r,i){return f(i,function(s,o,f){try{var l;!s&&o?s="*":u.test(s)&&(l=e(r).addClass(a),s="."+a+" "+s);var c=n(r,s)}catch(h){throw console.error("error performing selector: %o",i),h}finally{l&&l.removeClass(a)}return o?t.uniq(e.map(c,function(e,t){return o.call(e,t,c,f)})):c})},t.matches=function(e,t){return f(t,function(t,n,i){return(!t||r(e,t))&&(!n||n.call(e,null,i)===e)})}}(Zepto);
(function(){(function(b,h,i){function p(a,e){for(var c in a)if(f[a[c]]!==i)return"pfx"==e?a[c]:!0;return!1}var b={},k=h.documentElement;h.head||h.getElementsByTagName("head");var d=h.createElement("modernizr"),f=d.style,l=" -webkit- -moz- -o- -ms- -khtml- ".split(" "),q="Webkit Moz O ms Khtml".split(" "),d={},r=[],j,m={}.hasOwnProperty,n;typeof m!==i&&typeof m.call!==i?n=function(a,e){return m.call(a,e)}:n=function(a,e){return e in a&&typeof a.constructor.prototype[e]===i};d.rgba=function(){f.cssText=
"background-color:rgba(150,255,150,.5)";return!!~(""+f.backgroundColor).indexOf("rgba")};d.cssgradients=function(){var a=("background-image:"+l.join("gradient(linear,left top,right bottom,from(#9f9),to(white));background-image:")+l.join("linear-gradient(left top,#9f9, white);background-image:")).slice(0,-17);f.cssText=a;return!!~(""+f.backgroundImage).indexOf("gradient")};for(var o in d)n(d,o)&&(j=o.toLowerCase(),b[j]=d[o](),r.push((b[j]?"":"no-")+j));f.cssText="";d=null;b._version="2.0.6";b._prefixes=
l;b._domPrefixes=q;b.testProp=function(a){return p([a])};b.testAllProps=function(a,e){var c=a.charAt(0).toUpperCase()+a.substr(1),c=(a+" "+q.join(c+" ")+c).split(" ");return p(c,e)};b.testStyles=function(a,e,c,b){var d,f,g=h.createElement("div");if(parseInt(c,10))for(;c--;)f=h.createElement("div"),f.id=b?b[c]:"modernizr"+(c+1),g.appendChild(f);d=["&shy;<style>",a,"</style>"].join("");g.id="modernizr";g.innerHTML+=d;k.appendChild(g);a=e(g,a);g.parentNode.removeChild(g);return!!a};k.className=k.className.replace(/\bno-js\b/,
"")+(" js "+r.join(" "))})(window,document);var REC_BROWSERS,calc,mask,menu,scroll,step,stores,svc,_base,_base1,_ref,_ref1,_ref2,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};REC_BROWSERS="Google Chrome 15+, Mozilla Firefox 5+, Apple Safari 5+ and Opera 12.10+ are recommended.";if(/MSIE [1-8]\b|Mozilla\/[0-4]\.|Opera\/[0-9]\.[0-7]/i.test(navigator.userAgent)||((_ref=window.opera)!=null?_ref.version():void 0)<12.1){alert("This web app do not support your browser which lacks of some HTML5 features!\n"+
REC_BROWSERS);history.go(-1);return}if(window.Zepto!=null&&/MSIE/.test(navigator.userAgent)){alert("The underlaying framework used in this demo verion does not support IE!\n"+REC_BROWSERS);history.go(-1);return}if((_ref1=(_base=$.fn).outerWidth)==null)_base.outerWidth=$.fn.width;if((_ref2=(_base1=$.fn).outerHeight)==null)_base1.outerHeight=$.fn.height;menu=window.menu={};mask=menu.mask={active:false,el:$("#panel_mask"),show:function(msg,click_to_hide){var msgel,_this=this;msgel=this.el.find(".msg");
if(msg){msgel.html(msg).show();this.adj();this.active="msg"}else{msgel.hide();this.active="loading"}if(click_to_hide)this.el.one("click",function(){return _this.hide()});this.el.addClass("active")},hide:function(){var fade,_this=this;this.el.addClass("fade");fade=function(){_this.el.removeClass("active fade");_this.active=false;return _this.el.find(".msg").empty()};setTimeout(fade,500)},adj:function(){var msgel;msgel=this.el.find(".msg");msgel.css({"margin-left":-msgel.outerWidth()/2,"margin-top":-msgel.outerHeight()/
2})}};$("#demo-tip").click(menu.about=function(){var el;mask.show('<div id="about">Loading ...</div>',true);el=$(this).css("opacity",0);setTimeout(function(){return el.hide()},500);mask.el.one("click",function(){el.show();return setTimeout(function(){return el.css("opacity",1)},10)});$("#about").load("about.html",function(){return mask.adj()})});svc=menu.svc={get_stores:function(callback){return this.get("data/store-list.json",null,{success:callback,error:function(){return mask.show('Get Store List Failed<br/><a href="javascript:location.reload()">Reload</a>')}})},
get_menu:function(id,callback){return this.get("data/store-"+id+".json",null,{success:callback,error:function(){return mask.show("Get Menu Data Failed")}})},submit_order:function(order){var el,oid,_this=this;el=$("#step_review_checklist > fieldset").clone();el.children("legend").remove();sessionStorage.count=oid=1+Number(sessionStorage.count||1E3);sessionStorage["order-"+oid]=JSON.stringify(order);sessionStorage["order-html-"+oid]=el.html();mask.show("<h1>Your Order #"+oid+'(DEMO) submited.<br/>Now redirecting to <a href="order.html?'+
oid+'">Conformation Page (DEMO)</a>...</h1>');setTimeout(function(){return svc.forward("order.html?"+oid)},1E3)},forward:function(url){location.replace(url)},get:function(act,data,opt){var def;def={type:"GET",url:act,data:data,timeout:5E3};return this.ajax(def,opt)},ajax:function(def,cfg){var cmn,_this=this;mask.show();cmn={dataType:"json",contentType:"application/json;charset=utf-8",complete:function(xhr,txt){if((cfg!=null?cfg.complete:void 0)!=null)cfg.complete();if(menu.debug!=null)console.log(xhr,
txt);if(mask.active==="loading")return mask.hide()}};return $.ajax($.extend(cmn,def,cfg))}};stores=menu.stores=[];calc=menu.calc=function(){var burger,item,itm,store,store_id,type,_i,_len,_name,_ref3,_ref4;store_id=$("#store").val();burger={};store=stores.map[store_id];_ref3=$("#menu_form").serializeArray();for(_i=0,_len=_ref3.length;_i<_len;_i++){item=_ref3[_i];if(store[item.name].single)burger[item.name]=new Number(item.value);else{if((_ref4=burger[_name=item.name])==null)burger[_name]=[];burger[item.name].push(Number(item.value))}}burger.price=
0;for(type in burger){itm=burger[type];if(type==="weight")burger.price+=itm.price=store.weight[itm].price;else if(store[type]!=null)if(store[type].single)if(type==="bowl"&&store.free_bowl_weight===Number(burger.weight))itm.price=0;else burger.price+=itm.price=store[type].price;else{itm.price=(itm.length-store[type].free)*store[type].price;if(itm.price<0)itm.price=0;burger.price+=itm.price}}return burger};scroll=menu.scroll=function(){var not_bottom;this.scroll_at_top=this.scrollTop===0;not_bottom=
Math.abs(this.scrollHeight-this.scrollTop-$(this).height())>3;this.scrollable=this.scrollHeight>this.clientHeight&&not_bottom;$("#scroll_helper")[this.scrollable?"addClass":"removeClass"]("active");return true};step=menu.step={cur:0,init:function(){var delay,hack_css,i,len,n,o,onwheel,p,panel,sn,ss,steps,wheeling,_i,_len,_this=this;panel=this.panel=$("#slide_panel").show();steps=$("section.step");this.seq=[];for(_i=0,_len=steps.length;_i<_len;_i++){ss=steps[_i];sn=ss.id.slice(5);i=this[sn].idx=this.seq.length;
this.seq.push(sn);this[i]=this[sn];this[sn].name=sn;this[sn].el=$(ss)}len=this.length=this.seq.length;steps.append('<div class="spacer"/>');hack_css=function(){var h;h=panel.outerHeight()-35;steps.height(h).find("div.helper").css("top",h-85+"px")};$(window).resize(hack_css).resize();this.go(this.cur);$("#prev").click(function(){return _this.go(_this.cur.idx-1)});$("#next").click(function(){return _this.go(_this.cur.idx+1)});$("#apply").click(function(){return _this.commit()});$("#undo").click(function(){return _this.restore()});
panel.delegate('input.choice[name="bun"], input.choice[name="bowl"]',"change",function(e){var repel;repel=this.name==="bun"?"bowl":"bun";return $("input.choice[name="+repel+"]:checked").prop("checked",false)});panel.delegate("input.choice","change",function(){return _this.choose_store.choice_change()});if(window.Touch){$("#prev").on("touchstart",function(e){e.preventDefault();_this.go(_this.cur.idx-1);return false});$("#next").on("touchstart",function(e){e.preventDefault();_this.go(_this.cur.idx+
1);return false});$("#apply").on("touchstart",function(e){e.preventDefault();_this.commit();return false});$("#undo").on("touchstart",function(e){e.preventDefault();_this.restore();return false});panel.delegate("label.selection.single, label.selection.multi",{touchstart:function(e){e=e.originalEvent;this.spos={x:e.pageX,y:e.pageY};this.tap=true},touchmove:function(e){e=e.originalEvent;this.tap=Math.abs(e.pageX-this.spos.x)<16&&Math.abs(e.pageY-this.spos.y)<16},touchend:function(e){if(this.tap)$(this).find("input.choice").click();
this.tap=this.spos=null}});o=this;$(document.body).on({touchstart:function(e){e=e.originalEvent;this.start_y=e.pageY},touchmove:function(e){var oe,_ref3;oe=e.originalEvent;if(((_ref3=o.cur)!=null?_ref3.el:void 0)==null||oe.pageY>this.start_y&&o.cur.el[0].scroll_at_top||oe.pageY<this.start_y&&!o.cur.el[0].scrollable)e.preventDefault()}});panel.on({touchstart:function(e){var n,p;e=e.originalEvent;this.spos={x:e.pageX,y:e.pageY};this.cur_left=parseInt($(this).css("left"));n=$("#next");p=$("#prev");this.can_next=
!n.prop("disabled")&&n.css("display")!=="none";this.can_prev=!p.prop("disabled")&&p.css("display")!=="none";return true},touchmove:function(e){var mv;if(this.spos!=null){e=e.originalEvent;mv=(e.pageX-this.spos.x)*len*100/this.offsetWidth;if(!(mv<0&&this.can_next||mv>0&&this.can_prev))return true;else if(this.mv!=null||Math.abs(e.pageX-this.spos.x)>32&&Math.abs(e.pageY-this.spos.y)<128){this.mv=mv;return false}else return true}else return true},touchend:function(e){if(this.spos!=null&&this.mv!=null)if(Math.abs(this.mv)>
15)$(this.mv<0?"#next":"#prev").click();else $(this).css("left",this.cur_left+"%");this.spos=this.mv=null;return true}})}else if(__indexOf.call(document,"onmousewheel")>=0){n=$("#next");p=$("#prev");wheeling=0;delay=null;onwheel=function(e){var can_next,can_prev,stoped,x,y;if(menu.debug!=null)console.log("delta,x,y:",e.wheelDelta,e.wheelDeltaX,e.wheelDeltaY);x=Math.abs(e.wheelDeltaX);y=Math.abs(e.wheelDeltaY);if(x){e.preventDefault();e.stopPropagation();if(x>=120){if(++wheeling%120===1&&y<32){if(menu.debug!=
null)console.log("wheeling",wheeling);can_next=!n.prop("disabled")&&n.css("display")!=="none";can_prev=!p.prop("disabled")&&p.css("display")!=="none";x=e.wheelDeltaX;if(x<0&&can_next||x>0&&can_prev)$(x<0?"#next":"#prev").click()}stoped=function(){if(menu.debug!=null)console.log("stoped");delay=delay&&clearTimeout(delay);return wheeling=0};clearTimeout(delay);delay=setTimeout(stoped,300)}return false}return true};panel[0].onmousewheel=onwheel}if(window.jQuery!=null)if(/MSIE 9/.test(navigator.userAgent))mask.show("This web app only provide a limited UI on IE9!<br/>"+
REC_BROWSERS,true);else if(/MSIE 10/.test(navigator.userAgent))mask.show("This web app is temporary broken on IE10 for its strange CSS behaviors!<br/>"+REC_BROWSERS,true);return this},go:function(s){var i,_ref3,_ref4,_ref5,_this=this;if(this[s]&&this.cur!==this[s]){if(((_ref3=this.cur)!=null?_ref3.leave:void 0)!=null)this.cur.leave();if(((_ref4=this.cur)!=null?_ref4.el:void 0)!=null)this.cur.el.off("scroll",scroll);i=this[s].idx;this.prev=i>0?this[i-1]:null;this.cur=this[i];this.next=i<this.length-
1?this[i+1]:null;this.show((_ref5=this.cur.idx)===i-1||_ref5===i||_ref5===i+1?true:void 0);this.cur.el.on("scroll",scroll);this.cur.el.scroll();window.onhashchange=$.noop;location.hash=this.cur.name;window.onhashchange=function(){var btn;step=location.hash.replace("#","");btn=$("#next");if(_this[step]==null||mask.active)location.hash=_this.cur.name;else if(_this.cur.idx===_this.length-1||!btn.prop("disabled")&&btn.css("display")!=="none")_this.go(step);else location.hash=_this.cur.name}}return this},
show:function(jump){var i;i=this.cur.idx;this.panel.css("left",10-80*i+"%");$("#prev").prop("disabled",i===0);$("#next").prop("disabled",i===this.length-1);$("#float_price").css("opacity",0<i&&i<this.length-1?1:0);$("nav a.thumb.cur").removeClass("cur");$("nav a.thumb:eq("+i+")").addClass("cur");if(this.cur.init!=null)this.cur.init();if(this.cur.enter!=null)this.cur.enter();return this},validate:function(){var _ref3;if(((_ref3=this.cur)!=null?_ref3.validate:void 0)!=null)return this.cur.validate()},
commit:function(){var _ref3;if(((_ref3=this.cur)!=null?_ref3.commit:void 0)!=null)return this.cur.commit()},restore:function(){var _ref3;if(((_ref3=this.cur)!=null?_ref3.restore:void 0)!=null)return this.cur.restore()},choose_store:{init:function(){this.get_stores_data();step.choose_store.init=null;return this},get_stores_data:function(){var _this=this;svc.get_stores(function(data){var city,state,store,_base2,_i,_len,_name,_name1,_ref3,_ref4;stores=data;stores.tree={};stores.map={};for(_i=0,_len=
stores.length;_i<_len;_i++){store=stores[_i];state=(_ref3=(_base2=stores.tree)[_name=store.state])!=null?_ref3:_base2[_name]={};city=(_ref4=state[_name1=store.city])!=null?_ref4:state[_name1]=[];city.push(store);stores.map[store.id]=store}return _this.build_options()});return this},build_options:function(){var city_change,city_select,empty_option,open_hours,show_text,state,state_change,state_options,state_select,store_change,store_info,store_select,_this=this;empty_option='<option value="">Please Select</option>';
store_info=$("fieldset.info .store_info");open_hours=$("fieldset.info .open_hours");store_select=$("#store");city_select=$("#city");state_select=$("#state");store_change=function(e){var id,store;id=store_select.val();store=stores.map[id];_this.validate();if(store!=null){if(store.zip==null)store.zip="";store_info.html("<strong>"+store.desc+"</strong><br/>"+store.addr.replace(/\n|\\n/g,"<br/>")+"<br/>"+store.city+", "+store.state+", "+store.zip+"<br/>"+store.phone+"<br/>"+store.email);open_hours.html(store.hours.replace(/\n|\\n/g,
"<br/>"))}else store_info.add(open_hours).empty()};store_select.change(store_change);city_change=function(){var city,state,store,store_options,_i,_len;state=state_select.val();store_options=[];if(state&&this.value){city=stores.tree[state][this.value];for(_i=0,_len=city.length;_i<_len;_i++){store=city[_i];store_options.push('<option value="'+store.id+'">'+store.desc+"</option>")}}if(store_options.length!==1)store_options.unshift(empty_option);store_select.html(store_options.join("")).prop("disabled",
store_options.length===1);store_select.triggerHandler("change");if(store_options.length>1)store_select.focus()};city_select.change(city_change);state_options=[empty_option];for(state in stores.tree)state_options.push('<option value="'+state+'">'+state+"</option>");state_select.html(state_options.join(""));state_change=function(){var city,city_options;state=stores.tree[this.value];city_options=[];for(city in state)city_options.push('<option value="'+city+'">'+city+"</option>");if(city_options.length!==
1)city_options.unshift(empty_option);city_select.html(city_options.join("")).prop("disabled",city_options.length===1);city_select.triggerHandler("change");if(city_options.length>1)city_select.focus()};state_select.change(state_change);show_text=function(){$(this).siblings(".value").text($("option:selected",this).text()).parents(".select")[this.disabled?"addClass":"removeClass"]("disabled")};$("#step_choose_store select").change(show_text);state_select.change().focus();return this},get_menu_data:function(id){var btn,
cfg,_this=this;if(id==null)return;btn=$("#apply").prop("disabled",true);if(stores.map[id].type!=null)this.build_menu(stores.map[id]);else{cfg={type:{1:"meat",2:"weight",3:"cheese",4:"topping",5:"premium_topping",6:"sauce",7:"bun",8:"bowl"},choice:{},meat:{single:true},weight:{single:true},bun:{single:true},bowl:{single:true}};svc.get_menu(id,function(data){var choice,type,w,_i,_j,_k,_len,_len1,_len2,_ref3,_ref4,_ref5;data=$.extend(stores.map[id],cfg,data);_ref3=data.weights;for(_i=0,_len=_ref3.length;_i<
_len;_i++){w=_ref3[_i];data.weight[w.id]=w}_ref4=data.types;for(_j=0,_len1=_ref4.length;_j<_len1;_j++){type=_ref4[_j];type.free=type.free||0;type.price=type.price||0;type.t=data.type[type.id];$.extend(type,data[type.t]);type.fields=$("#"+type.t+"_fields");data[type.t]=data.type[type.id]=type}_ref5=data.choices;for(_k=0,_len2=_ref5.length;_k<_len2;_k++){choice=_ref5[_k];choice.type=data.type[choice.type];choice.t=choice.type.t;data.choice[choice.id]=data[choice.type.t][choice.id]=choice}_this.build_menu(data);
btn.hide().prop("disabled",true);$("#next").show().click();return data})}return this},build_menu:function(data){var choice,cls,fields,i,text,typ,type,type_info,w,_i,_j,_k,_len,_len1,_len2,_ref3,_ref4,_ref5;if((data!=null?data.type:void 0)!=null){$("#slide_panel label.selection").remove();fields=$("#weight_fields");_ref3=data.weights;for(_i=0,_len=_ref3.length;_i<_len;_i++){w=_ref3[_i];fields.append('<label id="weight_'+w.id+'" class="selection single"><input type="radio" class="choice" id="weight_'+
w.id+'_value" name="weight" value="'+w.id+'" data-price="'+w.price+'" /><span class="desc">'+w.desc+'</span><span class="info">'+w.price.toFixed(2)+"</span></label>")}_ref4=data.choices;for(i=_j=0,_len1=_ref4.length;_j<_len1;i=++_j){choice=_ref4[i];cls=choice.type.single?"single":"multi";typ=choice.type.single?"radio":"checkbox";choice.type.fields.append('<label id="'+choice.t+"_"+choice.id+'" class="selection '+cls+'"><input type="'+typ+'" class="choice" id="'+choice.t+"_"+choice.id+'_value" name="'+
choice.t+'" value="'+choice.id+'" /><span class="desc">'+choice.desc+"</span></label>")}_ref5=data.types;for(_k=0,_len2=_ref5.length;_k<_len2;_k++){type=_ref5[_k];type_info=type.fields.find("legend .info");if(type_info.length===1&&(type.free!=null||type.price!=null)&&type.t!=="weight"){text="";if(type.single){if(type.price>0)text="+"+type.price.toFixed(2);if(data.free_bowl_weight&&type.t==="bowl")text+=" (except 1lb)"}else{if(!type.free)text="Each selection ";else if(type.free===1)text="Extra selection ";
else text="Up to "+type.free+", extra selection ";text+=type.price.toFixed(2)}type_info.html(text)}if(type.t!=="weight")type.fields.find("label.selection").slice(0,3).each(function(i,o){return $(o).append('<span class="tops">Top'+(i+1)+"</span>")})}$("#meat_fields, #weight_fields, #bun_fields").find("input.choice:first").prop("checked",true);this.choice_change();$(window).resize();window.onbeforeunload=function(){if($("#menu_form").serialize().length>50)return"Really to leave?\nYour selections will be discard if you leave."}}return this},
choice_change:function(){var burger;$("label.selection.checked").removeClass("checked");$("input.choice:checked").parent("label.selection").addClass("checked");burger=calc();$("span.burger_price").text(burger.price.toFixed(2));return this},validate:function(){var chg,store_id;store_id=$("#store").val();if(this.store_id){chg=this.store_id!==store_id;$("#next, #prev")[chg?"hide":"show"]();$("#undo, #store_change_warning, #apply")[chg?"show":"hide"]()}$("#next, #apply").prop("disabled",!store_id);return Boolean(store_id)},
restore:function(){var store;if(this.store_id!=null&&stores.map[this.store_id]!=null){store=stores.map[this.store_id];$("#state").val(store.state).change();$("#city").val(store.city).change();$("#store").val(store.id).change()}return this},commit:function(){var store_id;store_id=$("#store").val()||null;if(store_id!=null&&store_id!==this.store_id){this.store_id=store_id;if(this.validate())this.get_menu_data(store_id)}return this}},choose_burger:{},choose_cheeses:{},choose_toppings:{},choose_sauces:{},
review_checklist:{init:function(){var email_el;$("#user_form").one("submit",function(e){var burgers,data,email,store_id,t,_this=this;e.preventDefault();e.stopPropagation();this.disabled=true;$("#prev").prop("disabled",true);store_id=Number($("#store").val());burgers=[calc()];email=$("#email").val();t=Date.parse(Date())/(6*36E5)|0;if(menu.debug!=null)t=Date.parse(Date())/1E3|0;window.onbeforeunload=$.noop;data={"store":store_id,"burgers":burgers};data.price=data.price;if(menu.debug!=null)console.log(data);
$("#popup_trace_user").removeClass("active");console.log(JSON.stringify(data,null,"\t"));menu.submit=function(){return svc.submit_order(data)};menu.submit();if(menu.debug>0)while(--menu.debug)svc.submit_order(data);return false});email_el=$("#email");if(typeof sessionStorage!=="undefined"&&sessionStorage!==null?sessionStorage.email:void 0)email_el.val(sessionStorage.email);if(email_el.prop("required"))$("#skip").click(function(){$("#email").removeAttr("required");return $("#user_form").submit()});
else $("#skip").hide();$("#submit").one("click",function(e){var show;$("button.nav").prop("disabled",true);show=function(){mask.el.find(".msg").hide();$("#panel_mask, #popup_trace_user").addClass("active");return $("#email").focus()};setTimeout(show,200);return false});this.init=null;return this},enter:function(){var bun_or_bowl,burger,store,store_id,tax,tax_rate;store_id=$("#store").val();store=stores.map[store_id];burger=calc();if(menu.debug!=null)console.log(JSON.stringify(burger));bun_or_bowl=
burger.bun!=null?store.bun[burger.bun].desc+" (On a Bun)":store.bowl[burger.bowl].desc+" (In a Bowl)";$("#review_burger div").html('<label class="selection">'+store.meat[burger.meat].desc+'</label><label class="selection">'+store.weight[burger.weight].desc+'</label><label class="selection">'+bun_or_bowl+"</label>");$("#review_burger .price").text((burger.weight.price+(burger.bowl!=null?burger.bowl.price:0)).toFixed(2));["cheese","topping","premium_topping","sauce"].forEach(function(type){var price,
review,tmp,_ref3,_ref4;tmp=$("<div/>");price=0;if((_ref3=burger[type])!=null?_ref3.length:void 0)burger[type].forEach(function(id){return tmp.append('<label class="selection">'+store[type][id].desc+"</label>")});else tmp.append('<label class="selection">None</label>');review=$("#review_"+type);review.find("div").replaceWith(tmp);return review.find(".price").text((((_ref4=burger[type])!=null?_ref4.price:void 0)||0).toFixed(2))});$("#burger_price").text(burger.price.toFixed(2));tax_rate=(store.tax_rate*
100).toFixed(5).replace(/.?0+$/,"");tax=Math.round(burger.price*store.tax_rate*100)/100;if(store.tax_rate)$("#tax_rate").text("("+tax_rate+"%)");$("#tax").text(tax.toFixed(2));$("#total_price").text((burger.price+tax).toFixed(2));return this}}};step.init()})();
